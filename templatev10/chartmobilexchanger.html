<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoEx - Trading Avanzado</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.16/dist/vue.js"></script>
    <link href="https://unpkg.com/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .bg-gray-750 {
            background-color: #1a202c;
        }
        .hover\:bg-gray-750:hover {
            background-color: #1a202c;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Header Sticky -->
        <header :class="isDark ? 'bg-gray-800 border-gray-700' : 'bg-white border-gray-300'" class="sticky top-0 z-50 border-b transition-colors duration-300">
            <div class="px-4 py-3 flex items-center justify-between">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-yellow-500 rounded-lg flex items-center justify-center font-bold text-gray-900">
                        CE
                    </div>
                    <span :class="isDark ? 'text-white' : 'text-gray-900'" class="font-bold text-lg">CryptoEx</span>
                </div>
                
                <!-- Toggle Switch -->
                <button @click="isDark = !isDark" :class="isDark ? 'bg-gray-700' : 'bg-gray-200'" class="relative w-14 h-7 rounded-full transition-colors duration-300">
                    <div :class="isDark ? 'translate-x-7 bg-yellow-500' : 'translate-x-1 bg-gray-400'" class="absolute top-1 left-0 w-5 h-5 rounded-full transition-transform duration-300 flex items-center justify-center">
                        <svg v-if="isDark" class="w-3 h-3 text-gray-900" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/>
                        </svg>
                        <svg v-else class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"/>
                        </svg>
                    </div>
                </button>
            </div>

            <!-- Par de trading y stats -->
            <div :class="isDark ? 'bg-gray-750 border-gray-700' : 'bg-gray-100 border-gray-200'" class="px-4 py-2 border-t">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center space-x-2">
                        <span :class="isDark ? 'text-white' : 'text-gray-900'" class="font-bold text-xl">{{ selectedPair }}</span>
                        <svg class="w-4 h-4" :class="isDark ? 'text-gray-400' : 'text-gray-600'" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <div :class="priceChange >= 0 ? 'text-green-500' : 'text-red-500'" class="text-sm font-bold flex items-center">
                        <svg v-if="priceChange >= 0" class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z"/>
                        </svg>
                        <svg v-else class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M14.707 10.293a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 111.414-1.414L9 12.586V5a1 1 0 012 0v7.586l2.293-2.293a1 1 0 011.414 0z"/>
                        </svg>
                        {{ priceChange >= 0 ? '+' : '' }}{{ priceChange.toFixed(2) }}%
                    </div>
                </div>
                <div class="flex items-center justify-between text-xs">
                    <div>
                        <span :class="isDark ? 'text-gray-400' : 'text-gray-600'">24h Alto: </span>
                        <span :class="isDark ? 'text-white' : 'text-gray-900'" class="font-semibold">{{ high24h }}</span>
                    </div>
                    <div>
                        <span :class="isDark ? 'text-gray-400' : 'text-gray-600'">24h Bajo: </span>
                        <span :class="isDark ? 'text-white' : 'text-gray-900'" class="font-semibold">{{ low24h }}</span>
                    </div>
                    <div>
                        <span :class="isDark ? 'text-gray-400' : 'text-gray-600'">Vol: </span>
                        <span :class="isDark ? 'text-white' : 'text-gray-900'" class="font-semibold">{{ volume24h }}</span>
                    </div>
                </div>
            </div>
        </header>

        <div :class="isDark ? 'bg-gray-900' : 'bg-gray-50'" class="min-h-screen transition-colors duration-300 pb-4">
            <div class="px-4 py-4 space-y-4">
                
                <!-- Gráfico de Velas -->
                <div :class="isDark ? 'bg-gray-800' : 'bg-white'" class="rounded-lg overflow-hidden">
                    <div :class="isDark ? 'bg-gray-750 border-gray-700' : 'bg-gray-100 border-gray-200'" class="px-4 py-3 border-b">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-2">
                                <h3 :class="isDark ? 'text-white' : 'text-gray-900'" class="font-semibold">Precio</h3>
                                <span :class="priceChange >= 0 ? 'text-green-500' : 'text-red-500'" class="font-extrabold text-xl">{{ currentPrice }}</span>
                            </div>
                            <select v-model="timeframe" :class="isDark ? 'bg-gray-700 text-white' : 'bg-gray-200 text-gray-900'" class="text-xs font-semibold px-2 py-1 rounded outline-none">
                                <option value="1m">1m</option>
                                <option value="5m">5m</option>
                                <option value="15m">15m</option>
                                <option value="1h">1h</option>
                                <option value="4h">4h</option>
                                <option value="1d">1D</option>
                            </select>
                        </div>
                    </div>

                    <!-- Canvas del Gráfico -->
                    <div :class="isDark ? 'bg-gray-900' : 'bg-gray-50'" class="p-4">
                        <svg width="100%" height="250" viewBox="0 0 350 250" preserveAspectRatio="xMidYMid meet">
                            <!-- Grid horizontal -->
                            <line v-for="i in 5" :key="'grid-' + i" 
                                  x1="0" 
                                  :y1="(250 / 5) * i" 
                                  x2="350" 
                                  :y2="(250 / 5) * i" 
                                  :stroke="isDark ? '#374151' : '#e5e7eb'" 
                                  stroke-width="1"/>
                            
                            <!-- Velas -->
                            <g v-for="(candle, index) in visibleCandles" :key="'candle-' + index">
                                <!-- Mecha -->
                                <line 
                                    :x1="candle.x" 
                                    :y1="candle.highY" 
                                    :x2="candle.x" 
                                    :y2="candle.lowY" 
                                    :stroke="candle.color" 
                                    stroke-width="1"/>
                                
                                <!-- Cuerpo -->
                                <rect 
                                    :x="candle.x - candle.width / 2" 
                                    :y="candle.bodyY" 
                                    :width="candle.width" 
                                    :height="candle.bodyHeight" 
                                    :fill="candle.color"/>
                            </g>

                            <!-- Línea de precio actual -->
                            <line 
                                x1="0" 
                                :y1="currentPriceY" 
                                x2="350" 
                                :y2="currentPriceY" 
                                stroke="#fbbf24" 
                                stroke-width="2" 
                                stroke-dasharray="5,5"/>
                            
                            <!-- Etiqueta de precio -->
                            <rect 
                                x="280" 
                                :y="currentPriceY - 12" 
                                width="65" 
                                height="24" 
                                fill="#fbbf24" 
                                rx="4"/>
                            <text 
                                x="312" 
                                :y="currentPriceY + 5" 
                                text-anchor="middle" 
                                fill="#1a1a1a" 
                                font-size="12" 
                                font-weight="bold">
                                {{ currentPrice }}
                            </text>
                        </svg>
                    </div>

                    <!-- Controles -->
                    <div :class="isDark ? 'bg-gray-750 border-gray-700' : 'bg-gray-100 border-gray-200'" class="px-4 py-2 border-t flex justify-between items-center">
                        <div class="flex space-x-2">
                            <button @click="zoomIn" :class="isDark ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'" class="px-3 py-1 rounded text-xs font-semibold transition-colors">+</button>
                            <button @click="zoomOut" :class="isDark ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'" class="px-3 py-1 rounded text-xs font-semibold transition-colors">-</button>
                        </div>
                        <div class="text-xs" :class="isDark ? 'text-gray-400' : 'text-gray-600'">
                            {{ candleCount }} velas
                        </div>
                    </div>
                </div>

                <!-- Botones de Compra y Venta -->
                <div class="grid grid-cols-2 gap-3">
                    <button 
                        @click="openQuickOrder('buy')"
                        class="bg-green-500 hover:bg-green-600 text-white font-bold py-4 rounded-lg transition-colors duration-200 flex items-center justify-center space-x-2">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z"/>
                        </svg>
                        <span class="text-lg">COMPRAR</span>
                    </button>
                    <button 
                        @click="openQuickOrder('sell')"
                        class="bg-red-500 hover:bg-red-600 text-white font-bold py-4 rounded-lg transition-colors duration-200 flex items-center justify-center space-x-2">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M14.707 10.293a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 111.414-1.414L9 12.586V5a1 1 0 012 0v7.586l2.293-2.293a1 1 0 011.414 0z"/>
                        </svg>
                        <span class="text-lg">VENDER</span>
                    </button>
                </div>

                <!-- Indicadores -->
                <div :class="isDark ? 'bg-gray-800' : 'bg-white'" class="rounded-lg p-4">
                    <h3 :class="isDark ? 'text-white' : 'text-gray-900'" class="font-semibold mb-3">Indicadores Técnicos</h3>
                    <div class="grid grid-cols-2 gap-3">
                        <div :class="isDark ? 'bg-gray-750' : 'bg-gray-100'" class="p-3 rounded-lg">
                            <div :class="isDark ? 'text-gray-400' : 'text-gray-600'" class="text-xs mb-1">RSI (14)</div>
                            <div class="flex items-center justify-between">
                                <span :class="isDark ? 'text-white' : 'text-gray-900'" class="font-bold text-lg">{{ rsi.toFixed(1) }}</span>
                                <span :class="getRSIColor()" class="text-xs font-semibold px-2 py-1 rounded">
                                    {{ getRSIStatus() }}
                                </span>
                            </div>
                        </div>
                        <div :class="isDark ? 'bg-gray-750' : 'bg-gray-100'" class="p-3 rounded-lg">
                            <div :class="isDark ? 'text-gray-400' : 'text-gray-600'" class="text-xs mb-1">MACD</div>
                            <div class="flex items-center justify-between">
                                <span :class="isDark ? 'text-white' : 'text-gray-900'" class="font-bold text-lg">{{ macd.toFixed(1) }}</span>
                                <span :class="macd > 0 ? 'text-green-500' : 'text-red-500'" class="text-xs font-semibold">
                                    {{ macd > 0 ? 'Alcista' : 'Bajista' }}
                                </span>
                            </div>
                        </div>
                        <div :class="isDark ? 'bg-gray-750' : 'bg-gray-100'" class="p-3 rounded-lg">
                            <div :class="isDark ? 'text-gray-400' : 'text-gray-600'" class="text-xs mb-1">MA (50)</div>
                            <div :class="isDark ? 'text-white' : 'text-gray-900'" class="font-bold text-lg">{{ ma50 }}</div>
                        </div>
                        <div :class="isDark ? 'bg-gray-750' : 'bg-gray-100'" class="p-3 rounded-lg">
                            <div :class="isDark ? 'text-gray-400' : 'text-gray-600'" class="text-xs mb-1">MA (200)</div>
                            <div :class="isDark ? 'text-white' : 'text-gray-900'" class="font-bold text-lg">{{ ma200 }}</div>
                        </div>
                    </div>
                </div>

                <!-- Trades Recientes -->
                <div :class="isDark ? 'bg-gray-800' : 'bg-white'" class="rounded-lg overflow-hidden">
                    <div :class="isDark ? 'bg-gray-750 border-gray-700' : 'bg-gray-100 border-gray-200'" class="px-4 py-3 border-b">
                        <h3 :class="isDark ? 'text-white' : 'text-gray-900'" class="font-semibold">Últimas Operaciones</h3>
                    </div>
                    <div class="px-4 py-2">
                        <div class="grid grid-cols-3 text-xs font-semibold mb-2" :class="isDark ? 'text-gray-400' : 'text-gray-600'">
                            <div>Precio</div>
                            <div class="text-right">Cantidad</div>
                            <div class="text-right">Hora</div>
                        </div>
                        <div class="space-y-1">
                            <div v-for="(trade, index) in recentTrades" :key="'trade-' + index" class="grid grid-cols-3 text-xs py-1">
                                <div :class="trade.side === 'buy' ? 'text-green-500' : 'text-red-500'" class="font-semibold">
                                    {{ trade.price }}
                                </div>
                                <div :class="isDark ? 'text-white' : 'text-gray-900'" class="text-right">
                                    {{ trade.amount }}
                                </div>
                                <div :class="isDark ? 'text-gray-400' : 'text-gray-600'" class="text-right">
                                    {{ trade.time }}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- Modal de Orden Rápida -->
        <div v-if="showQuickOrder" @click="closeQuickOrder" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-end md:items-center md:justify-center fade-in">
            <div @click.stop :class="isDark ? 'bg-gray-800' : 'bg-white'" class="w-full md:max-w-md md:rounded-lg rounded-t-2xl p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 :class="isDark ? 'text-white' : 'text-gray-900'" class="font-bold text-lg">
                        {{ quickOrderSide === 'buy' ? 'Compra Rápida' : 'Venta Rápida' }}
                    </h3>
                    <button @click="closeQuickOrder" :class="isDark ? 'text-gray-400 hover:text-white' : 'text-gray-600 hover:text-gray-900'" class="transition-colors">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    </button>
                </div>

                <div class="space-y-4">
                    <!-- Tipo -->
                    <div class="flex space-x-2">
                        <button 
                            @click="quickOrderType = 'market'" 
                            :class="quickOrderType === 'market' ? 'bg-yellow-500 text-gray-900' : (isDark ? 'bg-gray-700 text-gray-400' : 'bg-gray-200 text-gray-600')"
                            class="flex-1 py-2 rounded-lg font-semibold transition-colors duration-200">
                            Mercado
                        </button>
                        <button 
                            @click="quickOrderType = 'limit'" 
                            :class="quickOrderType === 'limit' ? 'bg-yellow-500 text-gray-900' : (isDark ? 'bg-gray-700 text-gray-400' : 'bg-gray-200 text-gray-600')"
                            class="flex-1 py-2 rounded-lg font-semibold transition-colors duration-200">
                            Límite
                        </button>
                    </div>

                    <!-- Precio -->
                    <div v-if="quickOrderType === 'limit'">
                        <label :class="isDark ? 'text-gray-400' : 'text-gray-600'" class="text-sm mb-2 block font-semibold">Precio</label>
                        <div :class="isDark ? 'bg-gray-700' : 'bg-gray-200'" class="rounded-lg p-3 flex items-center">
                            <input 
                                v-model="quickOrderPrice" 
                                type="number" 
                                placeholder="0.00" 
                                :class="isDark ? 'bg-gray-700 text-white' : 'bg-gray-200 text-gray-900'"
                                class="flex-1 outline-none font-semibold text-lg">
                            <span :class="isDark ? 'text-gray-400' : 'text-gray-600'" class="text-sm ml-2">USDT</span>
                        </div>
                    </div>

                    <!-- Cantidad -->
                    <div>
                        <label :class="isDark ? 'text-gray-400' : 'text-gray-600'" class="text-sm mb-2 block font-semibold">Cantidad</label>
                        <div :class="isDark ? 'bg-gray-700' : 'bg-gray-200'" class="rounded-lg p-3 flex items-center">
                            <input 
                                v-model="quickOrderAmount" 
                                type="number" 
                                placeholder="0.00" 
                                :class="isDark ? 'bg-gray-700 text-white' : 'bg-gray-200 text-gray-900'"
                                class="flex-1 outline-none font-semibold text-lg">
                            <span :class="isDark ? 'text-gray-400' : 'text-gray-600'" class="text-sm ml-2">BTC</span>
                        </div>
                    </div>

                    <!-- Porcentajes -->
                    <div class="grid grid-cols-4 gap-2">
                        <button @click="setQuickPercentage(25)" :class="isDark ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'" class="py-2 rounded text-sm font-semibold transition-colors">25%</button>
                        <button @click="setQuickPercentage(50)" :class="isDark ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'" class="py-2 rounded text-sm font-semibold transition-colors">50%</button>
                        <button @click="setQuickPercentage(75)" :class="isDark ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'" class="py-2 rounded text-sm font-semibold transition-colors">75%</button>
                        <button @click="setQuickPercentage(100)" :class="isDark ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'" class="py-2 rounded text-sm font-semibold transition-colors">100%</button>
                    </div>

                    <!-- Total -->
                    <div :class="isDark ? 'bg-gray-750' : 'bg-gray-100'" class="rounded-lg p-3">
                        <div class="flex items-center justify-between">
                            <span :class="isDark ? 'text-gray-400' : 'text-gray-600'" class="text-sm">Total Estimado</span>
                            <span :class="isDark ? 'text-white' : 'text-gray-900'" class="font-bold text-lg">{{ calculateQuickTotal() }} USDT</span>
                        </div>
                    </div>

                    <!-- Botón -->
                    <button 
                        @click="executeQuickOrder"
                        :class="quickOrderSide === 'buy' ? 'bg-green-500 hover:bg-green-600' : 'bg-red-500 hover:bg-red-600'"
                        class="w-full py-4 rounded-lg text-white font-bold text-lg transition-colors duration-200">
                        {{ quickOrderSide === 'buy' ? 'Comprar' : 'Vender' }} BTC
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        new Vue({
            el: '#app',
            data: {
                isDark: true,
                selectedPair: 'BTC/USDT',
                currentPrice: '67,234.50',
                priceChange: 2.45,
                high24h: '68,500.00',
                low24h: '65,800.00',
                volume24h: '1.2B',
                timeframe: '15m',
                candleCount: 20,
                rsi: 58.5,
                macd: 125.3,
                ma50: '66,890',
                ma200: '65,340',
                candles: [],
                recentTrades: [
                    { price: '67,234.50', amount: '0.0523', time: '14:23:45', side: 'buy' },
                    { price: '67,230.00', amount: '0.1245', time: '14:23:40', side: 'sell' },
                    { price: '67,235.80', amount: '0.0876', time: '14:23:35', side: 'buy' },
                    { price: '67,228.20', amount: '0.2134', time: '14:23:30', side: 'sell' },
                    { price: '67,240.00', amount: '0.0654', time: '14:23:25', side: 'buy' },
                ],
                showQuickOrder: false,
                quickOrderSide: 'buy',
                quickOrderType: 'market',
                quickOrderPrice: '',
                quickOrderAmount: '',
                balanceBTC: 0.5000,
                balanceUSDT: 10000.00,
            },
            computed: {
                visibleCandles() {
                    const candleWidth = 350 / this.candleCount;
                    const bodyWidth = candleWidth * 0.7;
                    
                    const prices = this.candles.flatMap(c => [c.high, c.low]);
                    const maxPrice = Math.max(...prices);
                    const minPrice = Math.min(...prices);
                    const priceRange = maxPrice - minPrice || 1;
                    
                    return this.candles.slice(-this.candleCount).map((candle, index) => {
                        const x = (index + 0.5) * candleWidth;
                        
                        const highY = 250 - ((candle.high - minPrice) / priceRange) * 230 - 10;
                        const lowY = 250 - ((candle.low - minPrice) / priceRange) * 230 - 10;
                        const openY = 250 - ((candle.open - minPrice) / priceRange) * 230 - 10;
                        const closeY = 250 - ((candle.close - minPrice) / priceRange) * 230 - 10;
                        
                        const color = candle.close >= candle.open ? '#0ecb81' : '#f6465d';
                        const bodyY = Math.min(openY, closeY);
                        const bodyHeight = Math.abs(closeY - openY) || 1;
                        
                        return {
                            x,
                            highY,
                            lowY,
                            bodyY,
                            bodyHeight,
                            width: bodyWidth,
                            color
                        };
                    });
                },
                currentPriceY() {
                    const prices = this.candles.flatMap(c => [c.high, c.low]);
                    const maxPrice = Math.max(...prices);
                    const minPrice = Math.min(...prices);
                    const priceRange = maxPrice - minPrice || 1;
                    const currentPriceNum = parseFloat(this.currentPrice.replace(/,/g, ''));
                    return 250 - ((currentPriceNum - minPrice) / priceRange) * 230 - 10;
                }
            },
            methods: {
                generateCandles() {
                    const basePrice = 67000;
                    this.candles = [];
                    
                    for (let i = 0; i < 50; i++) {
                        const open = basePrice + (Math.random() - 0.5) * 1000;
                        const close = open + (Math.random() - 0.5) * 500;
                        const high = Math.max(open, close) + Math.random() * 200;
                        const low = Math.min(open, close) - Math.random() * 200;
                        
                        this.candles.push({ open, close, high, low });
                    }
                },
                
                zoomIn() {
                    if (this.candleCount > 10) {
                        this.candleCount -= 5;
                    }
                },
                
                zoomOut() {
                    if (this.candleCount < 40) {
                        this.candleCount += 5;
                    }
                },
                
                getRSIColor() {
                    if (this.rsi > 70) return 'bg-red-500 text-white';
                    if (this.rsi < 30) return 'bg-green-500 text-white';
                    return this.isDark ? 'bg-gray-700 text-gray-300' : 'bg-gray-200 text-gray-700';
                },
                
                getRSIStatus() {
                    if (this.rsi > 70) return 'Sobrecompra';
                    if (this.rsi < 30) return 'Sobreventa';
                    return 'Neutral';
                },
                
                openQuickOrder(side) {
                    this.quickOrderSide = side;
                    this.showQuickOrder = true;
                    this.quickOrderPrice = this.currentPrice;
                    this.quickOrderAmount = '';
                },
                
                closeQuickOrder() {
                    this.showQuickOrder = false;
                },
                
                setQuickPercentage(percent) {
                    if (this.quickOrderSide === 'buy') {
                        const price = this.quickOrderType === 'limit' ? parseFloat(this.quickOrderPrice.replace(/,/g, '')) : parseFloat(this.currentPrice.replace(/,/g, ''));
                        const totalAvailable = this.balanceUSDT * (percent / 100);
                        this.quickOrderAmount = (totalAvailable / price).toFixed(6);
                    } else {
                        this.quickOrderAmount = (this.balanceBTC * percent / 100).toFixed(6);
                    }
                },
                
                calculateQuickTotal() {
                    const price = this.quickOrderType === 'limit' ? parseFloat(this.quickOrderPrice.replace(/,/g, '')) : parseFloat(this.currentPrice.replace(/,/g, ''));
                    const amount = parseFloat(this.quickOrderAmount) || 0;
                    return (price * amount).toFixed(2);
                },
                
                executeQuickOrder() {
                    if (!this.quickOrderAmount || parseFloat(this.quickOrderAmount) <= 0) {
                        alert('Por favor ingresa una cantidad válida');
                        return;
                    }
                    
                    if (this.quickOrderType === 'limit' && (!this.quickOrderPrice || parseFloat(this.quickOrderPrice.replace(/,/g, '')) <= 0)) {
                        alert('Por favor ingresa un precio válido');
                        return;
                    }
                    
                    const total = parseFloat(this.calculateQuickTotal());
                    
                    if (this.quickOrderSide === 'buy') {
                        if (total > this.balanceUSDT) {
                            alert('Balance insuficiente de USDT');
                            return;
                        }
                        this.balanceUSDT -= total;
                        this.balanceBTC += parseFloat(this.quickOrderAmount);
                    } else {
                        if (parseFloat(this.quickOrderAmount) > this.balanceBTC) {
                            alert('Balance insuficiente de BTC');
                            return;
                        }
                        this.balanceBTC -= parseFloat(this.quickOrderAmount);
                        this.balanceUSDT += total;
                    }
                    
                    const action = this.quickOrderSide === 'buy' ? 'Compra' : 'Venta';
                    const orderTypeText = this.quickOrderType === 'market' ? 'de mercado' : 'límite';
                    alert('Orden ' + orderTypeText + ' de ' + action.toLowerCase() + ' ejecutada!\n\nCantidad: ' + this.quickOrderAmount + ' BTC\nTotal: ' + this.calculateQuickTotal() + ' USDT');
                    
                    const now = new Date();
                    const time = String(now.getHours()).padStart(2, '0') + ':' + 
                                String(now.getMinutes()).padStart(2, '0') + ':' + 
                                String(now.getSeconds()).padStart(2, '0');
                    
                    this.recentTrades.unshift({
                        price: this.quickOrderType === 'limit' ? this.quickOrderPrice : this.currentPrice,
                        amount: this.quickOrderAmount,
                        time: time,
                        side: this.quickOrderSide
                    });
                    
                    if (this.recentTrades.length > 10) {
                        this.recentTrades.pop();
                    }
                    
                    this.closeQuickOrder();
                },
                
                updatePrice() {
                    setInterval(() => {
                        const currentPriceNum = parseFloat(this.currentPrice.replace(/,/g, ''));
                        const change = (Math.random() - 0.5) * 100;
                        const newPrice = currentPriceNum + change;
                        this.currentPrice = newPrice.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                        this.priceChange = parseFloat(((Math.random() - 0.5) * 5).toFixed(2));
                        
                        const lastCandle = this.candles[this.candles.length - 1];
                        const open = lastCandle.close;
                        const close = newPrice;
                        const high = Math.max(open, close) + Math.random() * 100;
                        const low = Math.min(open, close) - Math.random() * 100;
                        
                        this.candles.push({ open, close, high, low });
                        
                        if (this.candles.length > 50) {
                            this.candles.shift();
                        }
                        
                        this.rsi = 30 + Math.random() * 40;
                        this.macd = (Math.random() - 0.5) * 300;
                    }, 3000);
                }
            },
            mounted() {
                this.generateCandles();
                this.updatePrice();
            }
        });
    </script>
</body>
</html>